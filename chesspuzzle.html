<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Puzzles</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <style>
        .chess-board {
            width: 400px;
            height: 400px;
            margin: 20px auto;
            border: 2px solid #333;
            display: grid;
            grid-template-columns: repeat(8, 1fr);
        }

        .square {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            cursor: pointer;
        }

        .white {
            background-color: #f0d9b5;
        }

        .black {
            background-color: #b58863;
        }

        .selected {
            background-color: #7b61ff;
        }

        .valid-move {
            background-color: #90EE90;
        }

        .puzzle-info {
            text-align: center;
            margin: 20px;
            font-size: 1.2em;
        }

        .next-puzzle-btn {
            padding: 10px 20px;
            font-size: 1.1em;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
        }

        .next-puzzle-btn:hover {
            background-color: #45a049;
        }

        .feedback {
            margin: 10px;
            padding: 10px;
            border-radius: 5px;
            text-align: center;
        }

        .correct {
            background-color: #90EE90;
        }

        .incorrect {
            background-color: #ff6b6b;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Chess Puzzles</h1>
        <div class="puzzle-info">
            <p>Puzzle <span id="puzzleNumber">1</span> of 5</p>
            <p>Find the best move!</p>
        </div>
        <div class="chess-board" id="board"></div>
        <div id="feedback" class="feedback"></div>
        <button class="next-puzzle-btn" onclick="nextPuzzle()" style="display: none;">Next Puzzle</button>
    </div>

    <script>
        const puzzles = [
            {
                fen: 'r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 0 1',
                solution: ['e5', 'd4']
            },
            {
                fen: 'rnbqkbnr/pp1ppppp/8/2p5/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 1',
                solution: ['e4', 'c5']
            },
            {
                fen: 'r1bqkbnr/pppp1ppp/2n5/4p3/2B1P3/5N2/PPPP1PPP/RNBQK2R b KQkq - 0 1',
                solution: ['e5', 'd4']
            }
        ];

        let currentPuzzle = 0;
        let chess = new Chess();
        let selectedSquare = null;
        let validMoves = [];

        function initializeBoard() {
            const board = document.getElementById('board');
            board.innerHTML = '';
            chess.load(puzzles[currentPuzzle].fen);

            for (let rank = 7; rank >= 0; rank--) {
                for (let file = 0; file < 8; file++) {
                    const square = document.createElement('div');
                    square.className = `square ${(rank + file) % 2 === 0 ? 'white' : 'black'}`;
                    square.dataset.square = `${String.fromCharCode(97 + file)}${rank + 1}`;
                    square.addEventListener('click', () => handleSquareClick(square.dataset.square));
                    board.appendChild(square);
                }
            }
            updateBoard();
        }

        function updateBoard() {
            const pieces = chess.board();
            for (let rank = 0; rank < 8; rank++) {
                for (let file = 0; file < 8; file++) {
                    const square = document.querySelector(`[data-square="${String.fromCharCode(97 + file)}${8 - rank}"]`);
                    const piece = pieces[rank][file];
                    square.textContent = piece ? getPieceSymbol(piece) : '';
                }
            }
        }

        function getPieceSymbol(piece) {
            const symbols = {
                'p': '♟', 'n': '♞', 'b': '♝', 'r': '♜', 'q': '♛', 'k': '♚',
                'P': '♙', 'N': '♘', 'B': '♗', 'R': '♖', 'Q': '♕', 'K': '♔'
            };
            return symbols[piece.type.toUpperCase() + (piece.color === 'w' ? '' : '')];
        }

        function handleSquareClick(square) {
            if (selectedSquare === square) {
                selectedSquare = null;
                clearHighlights();
                return;
            }

            if (selectedSquare) {
                const move = chess.move({
                    from: selectedSquare,
                    to: square,
                    promotion: 'q'
                });

                if (move) {
                    checkSolution(move);
                }
                selectedSquare = null;
                clearHighlights();
            } else {
                selectedSquare = square;
                highlightSquare(square);
            }
        }

        function highlightSquare(square) {
            clearHighlights();
            const squareElement = document.querySelector(`[data-square="${square}"]`);
            squareElement.classList.add('selected');
        }

        function clearHighlights() {
            document.querySelectorAll('.square').forEach(square => {
                square.classList.remove('selected', 'valid-move');
            });
        }

        function checkSolution(move) {
            const solution = puzzles[currentPuzzle].solution;
            const moveString = `${move.from}${move.to}`;
            
            if (moveString === solution[0] + solution[1]) {
                document.getElementById('feedback').textContent = 'Correct! Well done!';
                document.getElementById('feedback').className = 'feedback correct';
                document.querySelector('.next-puzzle-btn').style.display = 'block';
            } else {
                document.getElementById('feedback').textContent = 'Try again!';
                document.getElementById('feedback').className = 'feedback incorrect';
                chess.undo();
                updateBoard();
            }
        }

        function nextPuzzle() {
            currentPuzzle = (currentPuzzle + 1) % puzzles.length;
            document.getElementById('puzzleNumber').textContent = currentPuzzle + 1;
            document.getElementById('feedback').textContent = '';
            document.getElementById('feedback').className = 'feedback';
            document.querySelector('.next-puzzle-btn').style.display = 'none';
            initializeBoard();
        }

        // Initialize the first puzzle
        initializeBoard();
    </script>
</body>
</html> 